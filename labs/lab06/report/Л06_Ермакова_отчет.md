---
## Front matter
title: "Отчет по лабораторной работе №6"
subtitle: "Дисциплина: архитектура компьютера"
author: "Ермакова Анастасия Алексеевна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Цель данной лабораторной работы - освоить арифметические инструкции языка ассемблера NASM.

# Задание

1. Символьные и численные данные в NASM
2. Выполнение арифметических операций в NASM
3. Выполнение заданий для самостоятельной работы

# Теоретическое введение

Большинство инструкций на языке ассемблера требуют обработки операндов. Адрес опе-
ранда предоставляет место, где хранятся данные, подлежащие обработке. Это могут быть
данные хранящиеся в регистре или в ячейке памяти.
• Регистровая адресация – операнды хранятся в регистрах и в команде используются
имена этих регистров, например: mov ax,bx.
• Непосредственная адресация – значение операнда задается непосредственно в ко-
манде, Например: mov ax,2.
• Адресация памяти – операнд задает адрес в памяти. В команде указывается символи-
ческое обозначение ячейки памяти, над содержимым которой требуется выполнить
операцию.
Ввод информации с клавиатуры и вывод её на экран осуществляется в символьном виде.
Кодирование этой информации производится согласно кодовой таблице символов ASCII.
ASCII – сокращение от American Standard Code for Information Interchange (Американский
стандартный код для обмена информацией). Согласно стандарту ASCII каждый символ
кодируется одним байтом.
Расширенная таблица ASCII состоит из двух частей. Первая (символы с кодами 0-127)
является универсальной (см. Приложение.), а вторая (коды 128-255) предназначена для
специальных символов и букв национальных алфавитов и на компьютерах разных типов
может меняться.
Среди инструкций NASM нет такой, которая выводит числа (не в символьном виде). По-
этому, например, чтобы вывести число, надо предварительно преобразовать его цифры в
ASCII-коды этих цифр и выводить на экран эти коды, а не само число. Если же выводить число
на экран непосредственно, то экран воспримет его не как число, а как последовательность
ASCII-символов – каждый байт числа будет воспринят как один ASCII-символ – и выведет на
экран эти символы.
Аналогичная ситуация происходит и при вводе данных с клавиатуры. Введенные дан-
ные будут представлять собой символы, что сделает невозможным получение корректного
результата при выполнении над ними арифметических операций.
Для решения этой проблемы необходимо проводить преобразование ASCII символов в
числа и обратно.

# Выполнение лабораторной работы
## Символьные и численные данные в NASM

Создаю каталог для программ лабораторной работы №6. (рис. [-@fig:001])

![Создание каталога для лабораторной работы](/home/anastasia/Загрузки/фото/Л06/1.png){#fig:001 width=70% }

Перехожу в созданный каталог и создаю файл lab6-1.asm. (рис. [-@fig:002])

![Создание файла lab6-1.asm](/home/anastasia/Загрузки/фото/Л06/2.png){#fig:002 width=70% }

Открываю файл с помощью текстового редактора mousepad и ввожу текст программы из листинка 6.1. Создаю исполняемый файл и запускаю его (рис. [-@fig:003]) Программа вывела символ j, т.к. он соответствует сумме двоичных кодов символов 4 и 6 по системе ASCII.

![Создание исполняемого файла. Результат его работы](/home/anastasia/Загрузки/фото/Л06/3.png){#fig:003 width=70% }

Вношу изменения в текст программы, вместо символов записываю регистры числа, заменяю '6' и '4' на 6 и 4.  (рис. [-@fig:004])

![Измененный текст программы](/home/anastasia/Загрузки/фото/Л06/4.png){#fig:004 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:005]) Результатом работы является символ с кодом 10, то есть символ перевода строки. На экран этот символ не отображается.

![Результат работы исполняемого файла](/home/anastasia/Загрузки/фото/Л06/5.png){#fig:005 width=70% }

Создаю файл lab6-2.asm и открывю его с помощью текстового редактора. (рис. [-@fig:006])

![Создание файла lab6-2.asm](/home/anastasia/Загрузки/фото/Л06/6.png){#fig:006 width=70% }

Ввожу в него текст программы из листинга 6.2. (рис. [-@fig:007])

![Текст программы](/home/anastasia/Загрузки/фото/Л06/7.png){#fig:007 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:008]) Программа вывела число 106, потому что она позволяет вывести именно число, а не код, после сложения символов '6' и '4'.

![Результат работы исполняемого файла](/home/anastasia/Загрузки/фото/Л06/8.png){#fig:008 width=70% }

Изменяю текст программы, заменяю '6' и '4' на числа 6 и 4. (рис. [-@fig:009])

![Измененный текст программы](/home/anastasia/Загрузки/фото/Л06/9.png){#fig:009 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:010]) Программа сложила 6 и 4, поэтому выводит число 10.

![Результат работы программы](/home/anastasia/Загрузки/фото/Л06/10.png){#fig:010 width=70% }

Заменяю в тексте программы функцию iprintLF на iprint. (рис. [-@fig:011]) Функция iprint не добавляет к выводу символ переноса строки, в отличие от функции iprintLF, поэтому после числа 10 нет переноса.

![Результат работы измененного файла](/home/anastasia/Загрузки/фото/Л06/11.png){#fig:011 width=70% }

## Выполнение арифметических операций в NASM

Создаю файл lab6-3.asm с помощью утилиты touch и ввожу в него текст программы из листинга 6.3 (рис. [-@fig:012])

![Текст программы файла lab6-3.asm](/home/anastasia/Загрузки/фото/Л06/12.png){#fig:012 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:013]) Результат работы программы совпадает с тем, что представлен в файле на ТУИС.

![Результат работы программы](/home/anastasia/Загрузки/фото/Л06/13.png){#fig:013 width=70% }

Вношу изменения в текст программы, чтобы она посчитала значение выражения (4*6 + 2)/5 (рис. [-@fig:014])

![Измененный текст программы](/home/anastasia/Загрузки/фото/Л06/14.png){#fig:014 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:015]) Результатом является 5, а остатком от деления 1. Программа работает верно.

![Результат работы измененной программы](/home/anastasia/Загрузки/фото/Л06/15.png){#fig:015 width=70% }

Далее создаю файл variant.asm и ввожу в него текст программы из листинга 6.4 (рис. [-@fig:016])

![Текст программы файла variant.asm](/home/anastasia/Загрузки/фото/Л06/16.png){#fig:016 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:017]) Программа вычислила вариант задания по номеру студенческого билета, который я ввела с клавиатуры. На экран вывелся мой вариант (19).

![Результат работы программы](/home/anastasia/Загрузки/фото/Л06/17.png){#fig:017 width=70% }

### Ответы на вопросы 

1. За вывод сообщения "Ваш вариант" отвечают следующие строки кода:

```
mov eax,rem
call sprint
```

2. Инструкция mov ecx, x используется для того, чтобы положить адрес вводимой строки х в регистр ecx. Инструкция mov edx,80 используется для того, чтобы записать в регистр edx длины вводимой строки. Инструкция call sread - для вызова подпрограммы из внешнего файла для ввода сообщения с клавиатуры.

3. Инструкция call atoi используется для вызова подпрограммы из внешнего файла для преобразования ASCII-кода символа в целое число и записывает результат в регистр eax.

4. За вычисление варианта отвечают следующие строки:
```
xor edx,edx ; обнуление edx для корректной работы div
mov ebx,20 ; ebx = 20 
div ebx ; eax = eax/20, edx - остаток от деления
inc edx ; edx = edx + 1
```

5. При выполнении инструкции div ebx остаток от деления записывается в регистр edx.

6. Инструкция inc edx увеличивает значение регистра edx на 1.

7. За вывод на экран результатов вычислений отвечают следующие строки:
```
mov eax,edx
call sprintLF
```

## Выполнение заданий для самостоятельной работы

Создаю файл lab6-4.asm с помощью утилиты touch и открываю файл для редактирования. (рис. [-@fig:018])

![Создание файла lab6-4.asm](/home/anastasia/Загрузки/фото/Л06/18.png){#fig:018 width=70% }

Ввожу в созданный файл текст программы для вычисления выражения под номером 19: (1/3*x + 5)*7 (рис. [-@fig:019])

![Текст программы файла lab6-4.asm](/home/anastasia/Загрузки/фото/Л06/19.png){#fig:019 width=70% }

Создаю исполняемый файл и запускаю его (рис. [-@fig:020]) Ввожу с клавиатуры значение переменной 3, результат выводится на экран - ответ 42. Повторно запускаю программу и ввожу 9, результатом является 56. Программа работает исправно, ответы верные.

![Результат работы программы](/home/anastasia/Загрузки/фото/Л06/20.png){#fig:020 width=70% }

Код программы для вычисления значения выражения (1/3*x + 5)*7:

```
%include 'in_out.asm'        ; подключение внешнего файла

SECTION .data                ; секция инициированных данных
msg: DB 'Введите значение переменной x: ',0
rem: DB 'Результат: ',0

SECTION .bss                 ; секция не инициированных данных
x: RESB 80                   ; переменная, значение которой будем вводить с клавиатуры

SECTION .text                ; код программы
GLOBAL _start                ; начало программы
_start:                      ; точка входа в программу

mov eax, msg                 ; запись адреса вводимого сообщения в eax
call sprint                  ; вызов подпрограммы печати сообщения

mov ecx,x                    ; запись адреса переменной х в есх
mov edx, 80                  ; запись длинны вводимого сообщения в edx
call sread                   ; вызов подпрограммы ввода сообщения

mov eax, x                   ; вызов подпрограммы преобразования
call atoi                    ; ASCII кода в число 'eax=x'

xor edx,edx                  ; обнуление edx для корректной работы div
mov ebx,3                    ; ebx = 3
div ebx                      ; eax = eax/3, edx - остаток от деления
add eax,5                    ; eax = eax+5
mov ebx,7                    ; ebx = 7
mul ebx                      ; eax = eax*ebx 

mov edi,eax                  ; запись результата вычисления в 'edi'

mov eax,rem                  ; вызов подпрограммы печати
call sprint                  ; сообщения 'Результат: '
mov eax,edi                  ; вызов подпрограммы печати значения 
call iprintLF                ; из 'edi' в виде символов

call quit                    ; вызов подпрограммы завершения
```

# Выводы

В ходе выполнения лабораторной работы я освоила арифметические инструкции языка ассемблера NASM.

# Список литературы

1. [Архитектура ЭВМ](https://esystem.rudn.ru/mod/resource/view.php?id=1030554)
